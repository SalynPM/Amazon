$(document).ready(function(){
fetch("https://www.amazon.com/drive/v1/shares/" + shareId + "?resourceVersion=V2&ContentType=JSON&asset=ALL").then(function(resp) {
		return resp.json();
	  }).then(function(json) {
		return fetch("https://www.amazon.com/drive/v1/nodes/" + json.nodeInfo.id + "/children?resourceVersion=V2&ContentType=JSON&limit=200&sort=%5B%22kind+DESC%22%2C+%22modifiedDate+DESC%22%5D&asset=ALL&tempLink=true&shareId=" + shareId);
	  }).then(function(resp) {
		return resp.json();
	  }).then(function(json) {
			var videoUrl = json.data[0].tempLink;
			var player = jwplayer("apicodes-player");
			player.setup({
				sources: [{file:videoUrl, type:"mp4"}],
				aspectratio: "16:9",
				startparam: "start",
				primary: "html5",
				preload: "auto",
				image: poster,
				captions: {
					color: "#f3f368",
					fontSize: 16,
					backgroundOpacity: 0,
					fontfamily: "Helvetica",
					edgeStyle: "raised"
				},
				tracks: [{ 
					file: sub, 
					label: "English",
					kind: "captions",
					"default": true 
				}]
			});
			player.on("setupError", function() {
			  swal("Server Error!", "Please contact us to fix it asap. Thank you!", "error");
			});
			player.on("error" , function(){
				swal("Server Error!", "Please contact us to fix it asap. Thank you!", "error");
			});
	  });
});
